"use strict";function cleanUp(e){["newfolder"].forEach(function(e){var t=path.join(fixtures,e);grunt.file.exists(t)&&grunt.file.delete(t)});e()}var gaze=require("../lib/gaze.js"),grunt=require("grunt"),path=require("path"),helper=require("./helper"),fixtures=path.resolve(__dirname,"fixtures"),sortobj=helper.sortobj;exports.matching={setUp:function(e){process.chdir(fixtures);cleanUp(e)},tearDown:cleanUp,globAll:function(e){e.expect(2);gaze("**/*",function(){var t=this.relative(null,!0);e.deepEqual(t["."],["Project (LO)/","nested/","one.js","sub/"]);e.deepEqual(t["sub/"],["one.js","two.js"]);this.close();e.done()})},relativeDir:function(e){e.expect(1);gaze("**/*",function(){e.deepEqual(this.relative("sub",!0),["one.js","two.js"]);this.close();e.done()})},globArray:function(e){e.expect(2);gaze(["*.js","sub/*.js"],function(){var t=this.relative(null,!0);e.deepEqual(sortobj(t["."]),sortobj(["one.js","Project (LO)/","nested/","sub/"]));e.deepEqual(sortobj(t["sub/"]),sortobj(["one.js","two.js"]));this.close();e.done()})},globArrayDot:function(e){e.expect(1);gaze(["./sub/*.js"],function(){var t=this.relative(null,!0);e.deepEqual(t["sub/"],["one.js","two.js"]);this.close();e.done()})},oddName:function(e){e.expect(1);gaze(["Project (LO)/*.js"],function(){var t=this.relative(null,!0);e.deepEqual(t["Project (LO)/"],["one.js"]);this.close();e.done()})},addedLater:function(e){e.expect(2);var t=0;gaze("**/*.js",function(n,r){r.on("all",function(n,i){t++;var s=r.relative(null,!0);e.deepEqual(s["newfolder/"],["added.js"]);t>1&&r.close()});grunt.file.write(path.join(fixtures,"newfolder","added.js"),"var added = true;");setTimeout(function(){grunt.file.write(path.join(fixtures,"newfolder","added.js"),"var added = true;")},1e3);r.on("end",function(){setTimeout(e.done,2e3)})})}};