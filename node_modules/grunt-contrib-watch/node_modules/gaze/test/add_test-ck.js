"use strict";var Gaze=require("../lib/gaze.js").Gaze,path=require("path"),fs=require("fs"),helper=require("./helper"),fixtures=path.resolve(__dirname,"fixtures"),sortobj=helper.sortobj;exports.add={setUp:function(e){process.chdir(fixtures);e()},addToWatched:function(e){e.expect(1);var t=["Project (LO)/","Project (LO)/one.js","nested/","nested/one.js","nested/three.js","nested/sub/","nested/sub/two.js","one.js"],n={"Project (LO)/":["one.js"],".":["Project (LO)/","nested/","one.js","sub/"],"nested/":["sub/","sub2/","one.js","three.js"],"nested/sub/":["two.js"]},r=new Gaze("addnothingtowatch");r._addToWatched(t);var i=r.relative(null,!0);e.deepEqual(sortobj(i),sortobj(n));e.done()},addLater:function(e){e.expect(3);new Gaze("sub/one.js",function(t,n){e.deepEqual(n.relative("sub"),["one.js"]);n.add("sub/*.js",function(){e.deepEqual(n.relative("sub"),["one.js","two.js"]);n.on("changed",function(t){e.equal("two.js",path.basename(t));n.close();e.done()});fs.writeFileSync(path.resolve(__dirname,"fixtures","sub","two.js"),"var two = true;")})})},addNoCallback:function(e){e.expect(1);new Gaze("sub/one.js",function(t,n){this.add("sub/two.js");this.on("changed",function(t){e.equal("two.js",path.basename(t));n.close();e.done()});setTimeout(function(){fs.writeFileSync(path.resolve(__dirname,"fixtures","sub","two.js"),"var two = true;")},500)})}};