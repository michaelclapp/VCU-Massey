/**
 * Object#toString() ref for stringify().
 */function promote(e,t){if(e[t].length==0)return e[t]={};var n={};for(var r in e[t])n[r]=e[t][r];e[t]=n;return n}function parse(e,t,n,r){var i=e.shift();if(!i)Array.isArray(t[n])?t[n].push(r):"object"==typeof t[n]?t[n]=r:"undefined"==typeof t[n]?t[n]=r:t[n]=[t[n],r];else{var s=t[n]=t[n]||[];if("]"==i)Array.isArray(s)?""!=r&&s.push(r):"object"==typeof s?s[Object.keys(s).length]=r:s=t[n]=[t[n],r];else if(~i.indexOf("]")){i=i.substr(0,i.length-1);!isint.test(i)&&Array.isArray(s)&&(s=promote(t,n));parse(e,s,i,r)}else{!isint.test(i)&&Array.isArray(s)&&(s=promote(t,n));parse(e,s,i,r)}}}function merge(e,t,n){if(~t.indexOf("]")){var r=t.split("["),i=r.length,s=i-1;parse(r,e,"base",n)}else{if(!isint.test(t)&&Array.isArray(e.base)){var o={};for(var u in e.base)o[u]=e.base[u];e.base=o}set(e.base,t,n)}return e}function parseObject(e){var t={base:{}};Object.keys(e).forEach(function(n){merge(t,n,e[n])});return t.base}function parseString(e){return String(e).split("&").reduce(function(e,t){var n=t.indexOf("="),r=lastBraceInKey(t),i=t.substr(0,r||n),s=t.substr(r||n,t.length),s=s.substr(s.indexOf("=")+1,s.length);""==i&&(i=t,s="");return""==i?e:merge(e,decode(i),decode(s))},{base:{}}).base}function stringifyString(e,t){if(!t)throw new TypeError("stringify expects an object");return t+"="+encodeURIComponent(e)}function stringifyArray(e,t){var n=[];if(!t)throw new TypeError("stringify expects an object");for(var r=0;r<e.length;r++)n.push(stringify(e[r],t+"["+r+"]"));return n.join("&")}function stringifyObject(e,t){var n=[],r=Object.keys(e),i;for(var s=0,o=r.length;s<o;++s){i=r[s];if(""==i)continue;null==e[i]?n.push(encodeURIComponent(i)+"="):n.push(stringify(e[i],t?t+"["+encodeURIComponent(i)+"]":encodeURIComponent(i)))}return n.join("&")}function set(e,t,n){var r=e[t];undefined===r?e[t]=n:Array.isArray(r)?r.push(n):e[t]=[r,n]}function lastBraceInKey(e){var t=e.length,n,r;for(var i=0;i<t;++i){r=e[i];"]"==r&&(n=!1);"["==r&&(n=!0);if("="==r&&!n)return i}}function decode(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}}var toString=Object.prototype.toString,isint=/^[0-9]+$/;exports.parse=function(e){return null==e||""==e?{}:"object"==typeof e?parseObject(e):parseString(e)};var stringify=exports.stringify=function(e,t){return Array.isArray(e)?stringifyArray(e,t):"[object Object]"==toString.call(e)?stringifyObject(e,t):"string"==typeof e?stringifyString(e,t):t+"="+encodeURIComponent(String(e))};