var Draft75Parser=function(e){this._socket=e;this._stage=0},instance={getVersion:function(){return"hixie-75"},handshakeResponse:function(){return new Buffer("HTTP/1.1 101 Web Socket Protocol Handshake\r\nUpgrade: WebSocket\r\nConnection: Upgrade\r\nWebSocket-Origin: "+this._socket.request.headers.origin+"\r\n"+"WebSocket-Location: "+this._socket.url+"\r\n\r\n","utf8")},isOpen:function(){return!0},parse:function(e){var t,n,r;for(var i=0,s=e.length;i<s;i++){t=e[i];switch(this._stage){case 0:this._parseLeadingByte(t);break;case 1:r=t&127;this._length=r+128*this._length;if(this._closing&&this._length===0)this._socket.close(null,null,!1);else if((128&t)!==128)if(this._length===0){this._socket.receive("");this._stage=0}else{this._buffer=[];this._stage=2}break;case 2:if(t===255){n=new Buffer(this._buffer);this._socket.receive(n.toString("utf8",0,this._buffer.length));this._stage=0}else{this._buffer.push(t);this._length&&this._buffer.length===this._length&&(this._stage=0)}}}},_parseLeadingByte:function(e){if((128&e)===128){this._length=0;this._stage=1}else{delete this._length;this._buffer=[];this._stage=2}},frame:function(e){if(Buffer.isBuffer(e))return e;var t=new Buffer(e,"utf8"),n=new Buffer(t.length+2);n[0]=0;n[t.length+1]=255;t.copy(n,1);return n}};for(var key in instance)Draft75Parser.prototype[key]=instance[key];module.exports=Draft75Parser;