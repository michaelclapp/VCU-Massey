function Client(e,t,n){this.ws=new WebSocket(e,t,n);this.ws.onmessage=this.message.bind(this);this.ws.onclose=this.close.bind(this);this.id=this.uniqueId("ws")}var util=require("util"),events=require("events"),WebSocket=require("faye-websocket");module.exports=Client;util.inherits(Client,events.EventEmitter);Client.prototype.message=function(t){var n=this.data(t);if(this[n.command])return this[n.command](n)};Client.prototype.close=function(t){if(this.ws){this.ws.close();this.ws=null}this.emit("end",t)};Client.prototype.hello=function(){this.send({command:"hello",protocols:["http://livereload.com/protocols/official-7"],serverName:"tiny-lr"})};Client.prototype.info=function(t){this.plugins=t.plugins;this.url=t.url};Client.prototype.reload=function(t){t.forEach(function(e){console.log("... Reload %s ...",e);this.send({command:"reload",path:e,liveCss:!0,liveJs:!0})},this)};Client.prototype.data=function(t){var n={};try{n=JSON.parse(t.data)}catch(r){}return n};Client.prototype.send=function(t){this.ws.send(JSON.stringify(t))};var idCounter=0;Client.prototype.uniqueId=function(t){var n=idCounter++;return t?t+n:n};