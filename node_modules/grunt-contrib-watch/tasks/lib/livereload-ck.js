/*
 * grunt-contrib-watch
 * http://gruntjs.com/
 *
 * Copyright (c) 2013 "Cowboy" Ben Alman, contributors
 * Licensed under the MIT license.
 */"use strict";var tinylr=require("tiny-lr"),servers=Object.create(null);module.exports=function(e){function n(n){n===!0?n=t:typeof n=="number"?n={port:n}:n=e.util._.defaults(n,t);if(servers[n.port])this.server=servers[n.port];else{this.server=tinylr();this.server.server.removeAllListeners("error");this.server.server.on("error",function(t){t.code==="EADDRINUSE"?e.fatal("Port "+n.port+" is already in use by another process."):e.fatal(t);process.exit(1)});this.server.listen(n.port,function(t){if(t)return e.fatal(t);e.log.verbose.writeln("Live reload server started on port: "+n.port)});servers[n.port]=this.server}}var t={port:35729};n.prototype.trigger=function(t){e.log.verbose.writeln("Live reloading "+e.log.wordlist(t)+"...");this.server.changed({body:{files:t}})};return function(e){return new n(e)}};