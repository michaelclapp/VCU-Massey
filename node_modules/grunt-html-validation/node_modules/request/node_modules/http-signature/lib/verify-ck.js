// Copyright 2011 Joyent, Inc.  All rights reserved.
var assert=require("assert-plus"),crypto=require("crypto");module.exports={verifySignature:function(t,n){assert.object(t,"parsedSignature");assert.string(n,"key");var r=t.algorithm.match(/(HMAC|RSA|DSA)-(\w+)/);if(!r||r.length!==3)throw new TypeError("parsedSignature: unsupported algorithm "+t.algorithm);if(r[1]==="HMAC"){var i=crypto.createHmac(r[2].toUpperCase(),n);i.update(t.signingString);return i.digest("base64")===t.params.signature}var s=crypto.createVerify(r[0]);s.update(t.signingString);return s.verify(n,t.params.signature,"base64")}};