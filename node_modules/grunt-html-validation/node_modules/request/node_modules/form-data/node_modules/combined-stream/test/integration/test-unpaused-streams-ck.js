var common=require("../common"),assert=common.assert,CombinedStream=common.CombinedStream,fs=require("fs"),FILE1=common.dir.fixture+"/file1.txt",FILE2=common.dir.fixture+"/file2.txt",EXPECTED=fs.readFileSync(FILE1)+fs.readFileSync(FILE2);(function(){var t=CombinedStream.create({pauseStreams:!1});t.append(fs.createReadStream(FILE1));t.append(fs.createReadStream(FILE2));var n=t._streams[0],r=t._streams[1];n.on("end",function(){assert.ok(r.dataSize>0)});var i=common.dir.tmp+"/combined.txt",s=fs.createWriteStream(i);t.pipe(s);s.on("end",function(){var e=fs.readFileSync(i,"utf8");assert.strictEqual(e,EXPECTED)})})();