var common=require("../common"),assert=common.assert,fake=common.fake.create(),DelayedStream=common.DelayedStream,Stream=require("stream").Stream;(function(){var t=new Stream,n=DelayedStream.create(t,{pauseStream:!1});fake.expect(n,"emit",0);var r=[];t.on("foo",function(e){r.push(e)});t.emit("foo",1);t.emit("foo",2);assert.deepEqual(r,[1,2]);fake.verify();fake.stub(n,"emit").times(Infinity).withArg(1,"newListener");fake.expect(n,"emit",["foo",1]);fake.expect(n,"emit",["foo",2]);fake.expect(t,"resume");n.resume();fake.verify();fake.expect(t,"resume");n.resume();fake.verify();fake.expect(n,"emit",["foo",3]);t.emit("foo",3);fake.verify()})();