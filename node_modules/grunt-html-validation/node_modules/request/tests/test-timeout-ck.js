var server=require("./server"),events=require("events"),stream=require("stream"),assert=require("assert"),request=require("../index"),s=server.createServer(),expectedBody="waited",remainingTests=5;s.listen(s.port,function(){function o(){if(--remainingTests==0){s.close();console.log("All tests passed.")}}s.on("/timeout",function(e,t){setTimeout(function(){t.writeHead(200,{"content-type":"text/plain"});t.write(expectedBody);t.end()},200)});var e={url:s.url+"/timeout",timeout:100};request(e,function(e,t,n){assert.equal(e.code,"ETIMEDOUT");o()});var t={url:s.url+"/timeout",timeout:300};request(t,function(e,t,n){assert.equal(e,null);assert.equal(expectedBody,n);o()});var n={url:s.url+"/timeout"};request(n,function(e,t,n){assert.equal(e);assert.equal(expectedBody,n);o()});var r={url:s.url+"/timeout",timeout:-1e3};request(r,function(e,t,n){assert.equal(e.code,"ETIMEDOUT");o()});var i={url:s.url+"/timeout",timeout:100.76};request(i,function(e,t,n){assert.equal(e.code,"ETIMEDOUT");o()})});