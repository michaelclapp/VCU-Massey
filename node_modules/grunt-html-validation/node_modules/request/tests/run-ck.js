var spawn=require("child_process").spawn,exitCode=0,timeout=1e4,fs=require("fs");fs.readdir(__dirname,function(e,t){if(e)throw e;var n=t.filter(function(e){return e.slice(0,"test-".length)==="test-"}),r=function(){n.length===0&&process.exit(exitCode);var e=n.shift();console.log(e);var t=spawn("node",["tests/"+e]),i=!1,s=setTimeout(function(){t.kill();exitCode+=1;console.error(e+" timeout");i=!0},timeout);t.stdout.pipe(process.stdout);t.stderr.pipe(process.stderr);t.on("exit",function(t){t&&!i&&console.error(e+" failed");exitCode+=t||0;clearTimeout(s);r()})};r()});