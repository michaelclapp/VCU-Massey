exports.CookieAccessInfo=CookieAccessInfo=function e(t,n,r,i){if(this instanceof e){this.domain=t||undefined;this.path=n||"/";this.secure=!!r;this.script=!!i;return this}return new e(t,n,r,i)};exports.Cookie=Cookie=function t(e){if(e instanceof t)return e;if(this instanceof t){this.name=null;this.value=null;this.expiration_date=Infinity;this.path="/";this.domain=null;this.secure=!1;this.noscript=!1;e&&this.parse(e);return this}return new t(e)};Cookie.prototype.toString=function n(){var e=[this.name+"="+this.value];this.expiration_date!==Infinity&&e.push("expires="+(new Date(this.expiration_date)).toGMTString());this.domain&&e.push("domain="+this.domain);this.path&&e.push("path="+this.path);this.secure&&e.push("secure");this.noscript&&e.push("httponly");return e.join("; ")};Cookie.prototype.toValueString=function(){return this.name+"="+this.value};var cookie_str_splitter=/[:](?=\s*[a-zA-Z0-9_\-]+\s*[=])/g;Cookie.prototype.parse=function(t){if(this instanceof Cookie){var n=t.split(";"),r=n[0].match(/([^=]+)=((?:.|\n)*)/),i=r[1],s=r[2];this.name=i;this.value=s;for(var o=1;o<n.length;o++){r=n[o].match(/([^=]+)(?:=((?:.|\n)*))?/),i=r[1].trim().toLowerCase(),s=r[2];switch(i){case"httponly":this.noscript=!0;break;case"expires":this.expiration_date=s?Number(Date.parse(s)):Infinity;break;case"path":this.path=s?s.trim():"";break;case"domain":this.domain=s?s.trim():"";break;case"secure":this.secure=!0}}return this}return(new Cookie).parse(t)};Cookie.prototype.matches=function(t){return this.noscript&&t.script||this.secure&&!t.secure||!this.collidesWith(t)?!1:!0};Cookie.prototype.collidesWith=function(t){if(this.path&&!t.path||this.domain&&!t.domain)return!1;if(this.path&&t.path.indexOf(this.path)!==0)return!1;if(this.domain===t.domain)return!0;if(this.domain&&this.domain.charAt(0)==="."){var n=t.domain.indexOf(this.domain.slice(1));if(n===-1||n!==t.domain.length-this.domain.length+1)return!1}else if(this.domain)return!1;return!0};exports.CookieJar=CookieJar=function r(){if(this instanceof r){var e={};this.setCookie=function(n){n=Cookie(n);var r=n.expiration_date<=Date.now();if(n.name in e){var i=e[n.name];for(var s=0;s<i.length;s++){var o=i[s];if(o.collidesWith(n)){if(r){i.splice(s,1);i.length===0&&delete e[n.name];return!1}return i[s]=n}}if(r)return!1;i.push(n);return n}return r?!1:e[n.name]=[n]};this.getCookie=function(n,r){var i=e[n];for(var s=0;s<i.length;s++){var o=i[s];if(o.expiration_date<=Date.now()){i.length===0&&delete e[o.name];continue}if(o.matches(r))return o}};this.getCookies=function(n){var r=[];for(var i in e){var s=this.getCookie(i,n);s&&r.push(s)}r.toString=function o(){return r.join(":")};r.toValueString=function(){return r.map(function(e){return e.toValueString()}).join(";")};return r};return this}return new r};CookieJar.prototype.setCookies=function(t){t=Array.isArray(t)?t:t.split(cookie_str_splitter);var n=[];for(var r=0;r<t.length;r++){var i=Cookie(t[r]);this.setCookie(i)&&n.push(i)}return n};