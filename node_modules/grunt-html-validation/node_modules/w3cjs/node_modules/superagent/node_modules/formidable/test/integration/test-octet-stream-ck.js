var common=require("../common"),formidable=common.formidable,http=require("http"),fs=require("fs"),path=require("path"),hashish=require("hashish"),assert=require("assert"),testFilePath=path.join(__dirname,"../fixture/file/binaryfile.tar.gz"),server=http.createServer(function(e,t){var n=new formidable.IncomingForm;n.parse(e,function(e,n,r){assert.equal(hashish(r).length,1);var i=r.file;assert.equal(i.size,301);var s=fs.readFileSync(i.path),o=fs.readFileSync(testFilePath);assert.deepEqual(s,o);t.end();server.close()})}),port=common.port;server.listen(port,function(e){assert.equal(e,null);var t=http.request({port:port,method:"POST",headers:{"Content-Type":"application/octet-stream"}});fs.createReadStream(testFilePath).pipe(t)});