/*
  Module dependencies
*/var _=require("underscore"),utils=require("./utils"),decode=utils.decode,encode=utils.encode,rboolean=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,formatAttrs=function(e){if(!e)return"";var t=[],n;for(var r in e){n=e[r];!n&&(rboolean.test(r)||r==="/")?t.push(r):t.push(r+'="'+encode(decode(n))+'"')}return t.join(" ")},singleTag={area:1,base:1,basefont:1,br:1,col:1,frame:1,hr:1,img:1,input:1,isindex:1,link:1,meta:1,param:1,embed:1,include:1,yield:1},tagType={tag:1,script:1,link:1,style:1,template:1},render=module.exports=function(e,t){!Array.isArray(e)&&!e.cheerio&&(e=[e]);t=t||{};var n=[],r=t.xmlMode||!1,i=t.ignoreWhitespace||!1;_.each(e,function(e){var i;tagType[e.type]?i=renderTag(e,r):e.type==="directive"?i=renderDirective(e):e.type==="comment"?i=renderComment(e):i=renderText(e);n.push(i);e.children&&n.push(render(e.children,t));(!singleTag[e.name]||r)&&tagType[e.type]&&(isClosedTag(e,r)||n.push("</"+e.name+">"))});return n.join("")},isClosedTag=function(e,t){return t&&(!e.children||e.children.length===0)},renderTag=function(e,t){var n="<"+e.name;e.attribs&&_.size(e.attribs)&&(n+=" "+formatAttrs(e.attribs));isClosedTag(e,t)&&(n+="/");return n+">"},renderDirective=function(e){return"<"+e.data+">"},renderText=function(e){return e.data},renderComment=function(e){return"<!--"+e.data+"-->"};