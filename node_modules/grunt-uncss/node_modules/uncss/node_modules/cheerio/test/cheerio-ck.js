var expect=require("expect.js"),_=require("underscore"),$=require("../"),fixtures=require("./fixtures"),fruits=fixtures.fruits,food=fixtures.food,script='<script src="script.js" type="text/javascript"></script>',multiclass='<p><a class="btn primary" href="#">Save</a></p>';describe("cheerio",function(){it("should get the version",function(){expect(/\d+\.\d+\.\d+/.test($.version)).to.be.ok()});it("$(null) should return be empty",function(){expect($(null)).to.be.empty()});it("$(undefined) should be empty",function(){expect($(undefined)).to.be.empty()});it("$(null) should be empty",function(){expect($("")).to.be.empty()});it("$(selector) with no context or root should be empty",function(){expect($(".h2")).to.be.empty();expect($("#fruits")).to.be.empty()});it("should be able to create html without a root or context",function(){var e=$("<h2>");expect(e).to.not.be.empty();expect(e).to.have.length(1);expect(e[0].name).to.equal("h2")});it("should be able to create complicated html",function(){var e=$(script);expect(e).to.not.be.empty();expect(e).to.have.length(1);expect(e[0].attribs.src).to.equal("script.js");expect(e[0].attribs.type).to.equal("text/javascript");expect(e[0].children).to.be.empty()});var e=function(e){expect(e).to.have.length(1);e=e[0];expect(e.parent.name).to.equal("ul");expect(e.prev).to.be(null);expect(e.next.attribs["class"]).to.equal("orange");expect(e.children).to.have.length(1);expect(e.children[0].data).to.equal("Apple")};it("should be able to select .apple with only a context",function(){var t=$(".apple",fruits);e(t)});it("should be able to select .apple with only a root",function(){var t=$(".apple",null,fruits);e(t)});it("should be able to select an id",function(){var e=$("#fruits",null,fruits);expect(e).to.have.length(1);expect(e[0].attribs.id).to.equal("fruits")});it("should be able to select a tag",function(){var e=$("ul",fruits);expect(e).to.have.length(1);expect(e[0].name).to.equal("ul")});it("should be able to filter down using the context",function(){var e=$.load(fruits),t=e(".apple","ul"),n=e("li","ul");expect(t).to.have.length(1);expect(n).to.have.length(3)});it("should select only elements inside given context (Issue #193)",function(){var e=$.load(food),t=e("#fruits"),n=e("li",t);expect(n).to.have.length(3)});it("should be able to select multiple tags",function(){var e=$("li",null,fruits);expect(e).to.have.length(3);var t=["apple","orange","pear"];e.each(function(e,n){expect(n.attribs["class"]).to.equal(t[e])})});it('should be able to do: $("#fruits .apple")',function(){var t=$("#fruits .apple",fruits);e(t)});it('should be able to do: $("li.apple")',function(){var t=$("li.apple",fruits);e(t)});it("should be able to select by attributes",function(){var t=$("li[class=apple]",fruits);e(t)});it('should be able to select multiple classes: $(".btn.primary")',function(){var e=$(".btn.primary",multiclass);expect(e).to.have.length(1);expect(e[0].children[0].data).to.equal("Save")});it('should be able to select multiple elements: $(".apple, #fruits")',function(){var t=$(".apple, #fruits",fruits);expect(t).to.have.length(2);var n=_(t).filter(function(e){return e.attribs["class"]==="apple"}),r=_(t).filter(function(e){return e.attribs.id==="fruits"});e(n);expect(r[0].attribs.id).to.equal("fruits")});it("should select first element $(:first)");it('should be able to select immediate children: $("#fruits > .pear")',function(){var e=$(food);$(".pear",e).append('<li class="pear">Another Pear!</li>');expect($("#fruits .pear",e)).to.have.length(2);var t=$("#fruits > .pear",e);expect(t).to.have.length(1);expect(t.attr("class")).to.equal("pear")});it('should be able to select immediate children: $(".apple + .pear")',function(){var e=$(".apple + li",fruits);expect(e).to.have.length(1);e=$(".apple + .pear",fruits);expect(e).to.have.length(0);e=$(".apple + .orange",fruits);expect(e).to.have.length(1);expect(e.attr("class")).to.equal("orange")});it('should be able to select immediate children: $(".apple ~ .pear")',function(){var e=$(".apple ~ li",fruits);expect(e).to.have.length(2);e=$(".apple ~ .pear",fruits);expect(e.attr("class")).to.equal("pear")});it('should handle wildcards on attributes: $("li[class*=r]")',function(){var e=$("li[class*=r]",fruits);expect(e).to.have.length(2);expect(e.eq(0).attr("class")).to.equal("orange");expect(e.eq(1).attr("class")).to.equal("pear")});it('should handle beginning of attr selectors: $("li[class^=o]")',function(){var e=$("li[class^=o]",fruits);expect(e).to.have.length(1);expect(e.eq(0).attr("class")).to.equal("orange")});it('should handle beginning of attr selectors: $("li[class$=e]")',function(){var e=$("li[class$=e]",fruits);expect(e).to.have.length(2);expect(e.eq(0).attr("class")).to.equal("apple");expect(e.eq(1).attr("class")).to.equal("orange")});it("should gracefully degrade on complex, unmatched queries",function(){var e=$("Eastern States Cup #8-fin&nbsp;<br>Downhill&nbsp;");expect(e).to.have.length(0)})});