var DomUtils=require("domutils"),hasAttrib=DomUtils.hasAttrib,getAttributeValue=DomUtils.getAttributeValue,falseFunc=require("./basefunctions.js").falseFunc,reChars=/[-[\]{}()*+?.,\\^$|#\s]/g,attributeRules={__proto__:null,equals:function(e,t){var n=t.name,r=t.value;if(t.ignoreCase){r=r.toLowerCase();return function(t){var i=getAttributeValue(t,n);return i!=null&&i.toLowerCase()===r&&e(t)}}return function(t){return getAttributeValue(t,n)===r&&e(t)}},hyphen:function(e,t){var n=t.name,r=t.value,i=r.length;if(t.ignoreCase){r=r.toLowerCase();return function(t){var s=getAttributeValue(t,n);return s!=null&&(s.length===i||s.charAt(i)==="-")&&s.substr(0,i).toLowerCase()===r&&e(t)}}return function(t){var s=getAttributeValue(t,n);return s!=null&&s.substr(0,i)===r&&(s.length===i||s.charAt(i)==="-")&&e(t)}},element:function(e,t){var n=t.name,r=t.value;if(/\s/.test(r))return falseFunc;r=r.replace(reChars,"\\$&");var i="(?:^|\\s)"+r+"(?:$|\\s)",s=t.ignoreCase?"i":"",o=new RegExp(i,s);return function(t){var r=getAttributeValue(t,n);return r!=null&&o.test(r)&&e(t)}},exists:function(e,t){var n=t.name;return function(t){return hasAttrib(t,n)&&e(t)}},start:function(e,t){var n=t.name,r=t.value,i=r.length;if(i===0)return falseFunc;if(t.ignoreCase){r=r.toLowerCase();return function(t){var s=getAttributeValue(t,n);return s!=null&&s.substr(0,i).toLowerCase()===r&&e(t)}}return function(t){var s=getAttributeValue(t,n);return s!=null&&s.substr(0,i)===r&&e(t)}},end:function(e,t){var n=t.name,r=t.value,i=-r.length;if(i===0)return falseFunc;if(t.ignoreCase){r=r.toLowerCase();return function(t){var s=getAttributeValue(t,n);return s!=null&&s.substr(i).toLowerCase()===r&&e(t)}}return function(t){var s=getAttributeValue(t,n);return s!=null&&s.substr(i)===r&&e(t)}},any:function(e,t){var n=t.name,r=t.value;if(r==="")return falseFunc;if(t.ignoreCase){var i=new RegExp(r.replace(reChars,"\\$&"),"i");return function(t){var r=getAttributeValue(t,n);return r!=null&&i.test(r)&&e(t)}}return function(t){var i=getAttributeValue(t,n);return i!=null&&i.indexOf(r)>=0&&e(t)}},not:function(e,t){var n=t.name,r=t.value;if(r==="")return function(t){return!!getAttributeValue(t,n)&&e(t)};if(t.ignoreCase){r=r.toLowerCase();return function(t){var i=getAttributeValue(t,n);return i!=null&&i.toLowerCase()!==r&&e(t)}}return function(t){return getAttributeValue(t,n)!==r&&e(t)}}};module.exports={compile:function(e,t){return attributeRules[t.action](e,t)},rules:attributeRules};