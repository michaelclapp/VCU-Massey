/*jslint node: true */"use strict";function uncss(e,t,n){var r,i,s,o,u,a;typeof e=="string"?s=[e]:s=utility.mapReadFiles(e);if(typeof t=="function"){o={};r=t}else{if(typeof t!="object"||typeof n!="function")throw"TypeError: expected a callback";o=t;r=n}o.csspath=typeof o.csspath=="string"?o.csspath:"";s=s.map(function(e){return cheerio.load(e)});if(o.stylesheets&&o.stylesheets.length>0)i=o.stylesheets;else{i=s.map(function(e){return utility.extract_stylesheets(e)});if(_.flatten(i).length===0){r("");return}i=i.map(function(t,n){return t.map(function(t){var r=path.join(path.dirname(e[n]),o.csspath,t);return r})});i=_.flatten(i);i=i.filter(function(e,t,n){return n.lastIndexOf(e)===t})}i=utility.mapReadFiles(i);u=css.parse(i.join("\n"));a=utility.filterUnusedRules(s,u.stylesheet,o.ignore);a=css.stringify(a);o.compress&&(a=csso.justDoIt(a));r(a)}var css=require("css"),csso=require("csso"),cheerio=require("cheerio"),path=require("path"),_=require("underscore"),utility=require("./lib.js");module.exports=uncss;